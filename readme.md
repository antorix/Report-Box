# Secretary

Программа для быстрого ввода отчетов и подсчета статистики.

![](https://github.com/antorix/Secretary/blob/master/screenshot.png)

***

## Установка и настройка

* Скачайте файл Secretary.py в любое место на вашем компьютере по ссылке: https://raw.githubusercontent.com/antorix/Secretary/master/Secretary.py.

* Скачайте и установите Python с [python.org](https://www.python.org/).

* Доустановите библиотеки keyboard и xlrd. Для этого в терминале (в режиме администратора) введите:
```
pip install keyboard
pip install xlrd
```
* Все бланки возвещателей S-21 должны находиться в папках с названиями: `Возвещатели`, `Возвещатели некрещеные`, `Пионеры`, `Пионеры подсобные`. При этом полные пути к этим папкам должны быть прописаны в первых строках файла Secretary.py (см. образец того, как это сделано сейчас).

* Пропишите в 5-й строке файла Secretary.py полный путь к PDF-читалке на вашем ПК.

* Запустите файл Secretary.py.

## Работа с программой

При первом запуске программа генерирует базу данных (в файле publishers.txt) из папок возвещателей. Это же происходит в отсутствие файла. В конце месяца файл publishers.txt можно удалить или зарезервировать, чтобы в начале нового месяца он сгенерировался заново.

### Ввод отчета

Введите фамилию возвещателя и данные его отчета в правильном порядке (как в бланке отчета) через табуляцию (клавиша Tab), например:

```
Иванов    10    5    50    7    0
```

Фамилию возвещателя можно ввести любым способом, с именем или без, полностью или частично, регистр не важен. Главное, чтобы присутствовала уникальная часть имени файла его PDF-бланка. Смотрите пример на скриншоте. Если часть окажется не уникальной, будет выведен весь список возвещателей и просьба уточнить. Если возвещатель корректно определен и уникален, его данные запишутся в базу, при этом автоматически откроется соответствующий PDF-файл S-21.

Теперь в файле поставьте курсор в ячейке «Публикации» соответствующего месяца и нажмите стрелку вправо. Введется значение. Нажмите Tab для перехода к следущей ячейке, снова нажмите вправо, и так далее до конца. Все данные подставлены. Нажмите Ctrl-W для сохранения и закрытия файла (Ctrl-W надо нажать обязательно для очистки буфера обмена).

Если просто ввести имя возвещателя без цифр, откроется его PDF-файл.

### Другие команды

* Вывод статистики: `=`

* Кто не сдал отчеты: `*`

* Открытие файла базы данных во внешнем редакторе: `\`

* Форсированная перезагрузка базы из папок возвещателей (пользуйтесь очень осторожно): `СБРОС`

* Импорт отчетов из таблицы в Excel-файле: `+`

  Для этой команды положите любой Excel-файл в общую папку с программой. Название может быть любым, но расширение должно быть ".xlsx". Файл должен иметь такую структуру:

  | A | B | C | D | E | F |
  |--------|---|---|---|---|---|
  | Иванов | 1 | 2 | 3 | 4 | 5 |
  | Петров | 1 | 2 | 3 | 4 | 5 |
  | Сидоров| 1 | 2 | 3 | 4 | 5 |

* Открытие данной справки: `?`
