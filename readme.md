# Secretary

Программа для быстрого ввода отчетов и подсчета статистики.

![](https://github.com/antorix/Secretary/blob/master/screenshot.png)

***

## Установка и настройка

* Скачайте Python с python.org.

* Доустановите библиотеки keyboard, xlrd и glob. Для этого в терминале (в режиме администратора) введите:
```
pip install keyboard
pip install xlrd
pip install glob
```
* Пропишите в 5-й строке файла secretary.py полный путь к PDF-читалке на вашем ПК (косые черты должны быть двойными).

* Все бланки S-21 возвещателей должны находиться в папках с названиями: `Возвещатели`, `Возвещатели некрещеные`, `Пионеры`, `Пионеры подсобные`. При этом полные пути к этим папкам должны быть прописаны в первых строках файла secretary.py (см. образец того, как это сделано сейчас).

## Работа с программой

### Ввод отчета

Введите имя возвещателя и данные его отчета в правильном порядке (как в бланке отчета) через табуляцию (клавиша Tab), например:

```
Иванов  10  5 50  7 0
```

Имя возвещателя можно ввести любым способом, с фамилией или без, полностью или частично, регистр не важен. Смотрите пример на скриншоте. Главное, чтобы присутствовала уникальная часть имени файла его PDF-бланка. Если часть окажется не уникальной, будет выведен весь список возвещателей и просьба уточнить. Если возвещатель корректно определен и уникален, его данные запишутся в базу, при этом автоматически откроется соответствующий PDF-файл S-21.

Теперь в файле поставьте курсор в поле «Публикации» соответствующего месяца и нажмите стрелку вправо. Введется значение. Нажмите Tab для перехода к следущей ячейке, снова нажмите вправо, и так далее до конца. Все данные подставлены. Нажмите Ctrl-W для закрытия файла (Ctrl-W надо нажать обязательно для очистки буфера обмена).

Если просто ввести имя возвещателя без цифр, откроется его PDF-файл.

В конце месяца файл publishers.txt можно удалить или заархивировать, чтобы в начале нового месяца он сгенерировался заново.

### Другие команды

* Вывод статистики: `=`

* Кто не сдал отчеты: `*`

* Экспорт отчетов из таблицы в Excel-файле: `+`

* Форсированная очистка и перезагрузка базы данных из папок возвещателей (пользуйтесь очень осторожно): `СБРОС`

Для этой команды положите любой Excel-файл в общую папку с программой. Название может быть любым, но расширение должно быть ".xlsx". Файл должен иметь такую структуру:

| A | B | C | D | E | F |
|--------|---|---|---|---|---|
| Иванов | 1 | 2 | 3 | 4 | 5 |
| Петров | 1 | 2 | 3 | 4 | 5 |
| Сидоров| 1 | 2 | 3 | 4 | 5 |

* Открытие данной справки: `?`
